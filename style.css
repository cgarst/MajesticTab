/* ==========================================================================
   CSS Variables & Root Settings
   ========================================================================== */
:root {
    --page-bg-color: white;
    --outside-bg-color: #f8f9fa;
    --text-color: black;
    --border-color: #aaaaaa;
    --page-shadow: 0 2px 6px rgba(0,0,0,0.1);
    --separator-color: #ccc;
    --page-padding: 20px;
    --highlight-color: #9966cc;
}

/* ==========================================================================
   Base Layout
   ========================================================================== */
body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: #f8f9fa;
    overflow: hidden;
}

body.dark-mode {
    background-color: #1e1e1e;
    color: #ddd;
    --outside-bg-color: #1e1e1e;
    --page-bg-color: #000000;
    --text-color: #ddd;
    --border-color: #444;
    --page-shadow: 0 2px 6px rgba(0,0,0,0.7);
    --separator-color: #444;
    --highlight-color: #884dbc;
}

/* ==========================================================================
   Navigation & Controls
   ========================================================================== */
/* Navbar Layout */
.navbar {
    /* Layout */
    position: relative;
    flex-wrap: nowrap !important;
    overflow-x: auto;
    
    /* Spacing */
    padding-top: 0.3rem !important;
    padding-bottom: 0.3rem !important;
    
    /* Colors */
    background-color: #3a3f44 !important;
    color: var(--text-color);
}

/* Navbar Elements */
.navbar-brand {
    white-space: nowrap;
}

.navbar .toolbar-items {
    flex-wrap: nowrap !important;
}

/* Button Base Styles */
.btn-check:focus + .btn, 
.btn:focus { 
    box-shadow: none !important; 
}

.btn-check + .btn { 
    pointer-events: auto !important; 
}

/* Primary Button Styles */
.btn-outline-primary { 
    color: var(--highlight-color);
    border-color: var(--highlight-color);
}

.btn-outline-primary:hover,
.btn-outline-primary:active,
.btn-check:checked + label.btn-outline-primary {
    background-color: var(--highlight-color);
    color: var(--text-color);
    border-color: var(--highlight-color);
}

.btn-outline-primary:focus {
    background-color: transparent;
    color: var(--highlight-color);
    border-color: var(--highlight-color);
    box-shadow: none;
}

/* Navbar buttons and labels */
.navbar .navbar-brand,
.navbar .btn,
.navbar .btn-check + label {
    border-color: var(--highlight-color);
    color: white;
}

.navbar .btn-primary {
    background-color: var(--highlight-color);
    border-color: var(--highlight-color);
    color: white;
}

.navbar .btn-primary:hover {
    background-color: var(--highlight-color);
    border-color: var(--highlight-color);
    color: white;
}

.navbar .btn:hover {
    border-color: var(--highlight-color) !important;
    color:  var(--highlight-color);
}

#modeButtons {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
}

#navButtons {
    display: none;
    align-items: center;
    gap: 0.5rem;
    white-space: nowrap;
}

#pageIndicator {
    display: inline-block;
    white-space: nowrap;
    min-width: 4em;
    text-align: center;
    margin: 0;
    padding: 0;
    color: white;
}

/* ==========================================================================
   Main Content Layout
   ========================================================================== */
#output {
    /* Base layout */
    overscroll-behavior: contain;
    min-height: 0;
    flex: 1;
    width: 100%;
    height: 100%;
    position: relative;
    
    /* Display and box model */
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    
    /* Overflow handling */
    overflow: hidden;
    overflow-x: hidden;
    
    /* Visual styles */
    background-color: var(--outside-bg-color);
    transform-origin: 0 0;
    will-change: transform;
    
    /* Zoom containment */
    contain: paint;
}

/* AlphaTab container styles */
/* ==========================================================================
   AlphaTab Specific Styles
   ========================================================================== */
.alphaTabContainer {
    width: 860px;
    margin: 0 auto;
    overflow: visible;
    box-shadow: var(--page-shadow);
    border: 1px solid var(--border-color);
    box-sizing: border-box;
}

.alphaTab-gp-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    flex: 1;
    width: 100%;
    padding: 10px;
    box-sizing: border-box;
}

.alphaTab-gp-content > * {
    max-width: 100%;
    position: relative !important;
}

g.at text {
    font-family: 'alphaTab' !important;
}

#output svg text, rect {
  fill: var(--text-color) !important;
  stroke: none !important;
}

#output.dark-mode svg text, rect {
  fill: var(--text-color) !important;
  stroke: var(--border-color) !important;
}

/* ==========================================================================
   Guitar Pro Page Styles
   ========================================================================== */
.gp-page-container {
    height: 100%;
    width: 100%;
    display: flex;
    align-items: stretch;
    gap: 10px;
    padding: 10px;
}

.gp-page-wrapper {
    flex: 1;
    height: auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    box-shadow: var(--page-shadow);
    border: 1px solid var(--border-color);
    box-sizing: border-box;
    background-color: var(--page-bg-color);
    margin-left: auto;
    margin-right: auto;
    user-select: none;
}

/* Output styles for continuous mode */
#output.continuous-mode {
    overflow-y: auto;
    align-items: center;
    background-color: var(--outside-bg-color);
}

#topBar {
    position: sticky;
    top: 0;
    z-index: 1000;
    transform: scale(1) !important; /* Prevent top bar from being affected by zoom */
}

#mainContent {
    flex: 1;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
    position: relative;
    min-height: 0;
    isolation: isolate; /* Create a new stacking context */
    width: 100%;
}

#output {
    transform-origin: 0 0;
    will-change: transform;
    position: relative;
    min-height: 0;
    height: 100%;
}
/* ==========================================================================
   Button Base Styles
   ========================================================================== */
/* Button focus states */
.btn-check:focus + .btn, 
.btn:focus { 
    box-shadow: none !important; 
}

.btn-check + .btn { 
    pointer-events: auto !important; 
}

/* Primary outline button styles */
.btn-outline-primary { 
    color: var(--highlight-color);
    border-color: var(--highlight-color);
}

.btn-outline-primary:hover,
.btn-outline-primary:active,
.btn-check:checked + label.btn-outline-primary {
    background-color: var(--highlight-color);
    color: white;
    border-color: var(--highlight-color);
}

.btn-outline-primary:focus {
    background-color: transparent;
    color: var(--highlight-color);
    border-color: var(--highlight-color);
    box-shadow: none;
}

/* ==========================================================================
   Canvas Element Styles
   ========================================================================== */
canvas { 
    display: block; 
    margin: 0 auto; 
    background: white; 
    max-width: 100%; 
    height: auto; 
}

/* Outer container styles */
.outer-container {
    width: 100%;
    height: 100%;
    background-color: var(--outside-bg-color);
    overflow: hidden;
}

/* Page container styles */
.pageContainer { 
    display: flex; 
    justify-content: center; 
    align-items: flex-start; 
    gap: 20px; 
    padding: var(--page-padding);
    min-height: 100%;
    box-sizing: border-box;
    overflow: hidden;
    width: 100%;
    height: 100%;
}

/* Page wrapper styles */
.pageWrapper { 
    position: relative;
    width: 100%;
    height: 100%;
    min-height: calc(100vh - 80px);
    background-color: var(--page-bg-color);
    color: var(--text-color);
    box-shadow: var(--page-shadow);
    border: 1px solid var(--border-color);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    max-width: 95%;
    overflow: hidden;
}

/* Page content styles */
.pageWrapper > div {
    margin: 0;
    padding: var(--page-padding);
    width: 100%;
    flex: 1;
    box-sizing: border-box;
    font-size: 14px;
    font-family: monospace;
    line-height: 1.5;
}

.pageNumber {
  position: absolute;
  bottom: 5px;
  right: 5px;
  background: rgba(255, 255, 255, 0.8);
  padding: 2px 5px;
  font-size: 12px;
  text-align: right;
}

#progressContainer {
  width: 100%;
  height: 8px;
  background: #ddd;
  margin: 5px 0;
  border-radius: 5px;
  overflow: hidden;
  display: none;
}

#progressBar {
  height: 100%;
  width: 0%;
  background: #9966cc;
  transition: width 0.2s;
}@keyframes indeterminate {
  0% { left: -40%; width: 40%; }
  50% { left: 30%; width: 30%; }
  100% { left: 100%; width: 40%; }
}

.indeterminate {
  position: relative;
  animation: indeterminate 1.2s infinite linear;
}
/* Navbar styles consolidated in Navigation & Controls section */

/* Offcanvas Menu */
.offcanvas {
  background-color: #2f343a;
  color: white;
}

.offcanvas .form-control {
  background-color: #3a3f44;
  color: white;
  border-color: #5c5c5c;
}

.offcanvas .form-control:focus {
  background-color: #3a3f44;
  color: white;
  border-color: #9966cc;
  box-shadow: 0 0 0 0.2rem rgba(153, 102, 204, 0.25);
}

.offcanvas .form-check-input:checked {
  background-color: #9966cc;
  border-color: #9966cc;
}

.offcanvas .form-check-label {
  color: white;
}

/* Range/Slider inputs */
input[type=range]::-webkit-slider-thumb { background: #9966cc; }
input[type=range]::-moz-range-thumb { background: #9966cc; }

/* Consolidated output styles moved to Main Content Layout section */

/* Chord-lyric line styles */
.chord-lyric-line {
    display: flex;
    flex-wrap: wrap;
    gap: 0 4px;
    width: 100%;
    white-space: normal;
}

.chord-lyric-segment {
    display: inline-flex;
    flex-direction: column;
    align-items: flex-start;
    font-family: monospace;
    line-height: 1.5;
}

.chord-lyric-chord {
    min-height: 1.5em;
    color: #2c5282;
    font-weight: bold;
}

/* Plain text line style */
.text-line {
    font-family: monospace;
    line-height: 1.5;
    white-space: pre-wrap;
}

/* Measurement div for pagination */
.measure-div {
    position: absolute;
    visibility: hidden;
    padding: var(--page-padding);
    box-sizing: border-box;
    font-family: monospace;
    font-size: 14px;
    line-height: 1.5;
}

/* Tab section styles */
.tab-section-container {
    break-inside: avoid-page;
    break-before: avoid-page;
}

/* Section separator styles */
.section-separator {
    margin: 1em 0;
    border-top: 1px solid var(--separator-color);
    break-after: avoid-page;
}

/* Text content styles */
.text-content {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--page-padding);
    font-family: monospace;
    line-height: 1.5;
    background-color: var(--page-bg-color);
    color: var(--text-color);
    box-shadow: var(--page-shadow);
    border: 1px solid var(--border-color);
    box-sizing: border-box;
    font-size: 14px;
    margin: 20px;
    user-select: none;
}

/* Scrollbar for continuous mode */
#output::-webkit-scrollbar { width:8px; }
#output::-webkit-scrollbar-track { background:#ccc; }
#output::-webkit-scrollbar-thumb { background: var(--highlight-color); border-radius:4px; }

/* Utility Classes */
span.me-2 {
    margin-right: 0px !important;
}

/* Dark mode */

body.dark-mode .pageWrapper {
    background-color: var(--page-bg-color) !important;
    border-color: var(--border-color);
    box-shadow: 0 2px 6px rgba(0,0,0,0.7);
}

body.dark-mode .alphaTabContainer {
    background-color: var(--page-bg-color);
}

body.dark-mode .pageContainer {
    background-color: var(--outside-bg-color);
}

body.dark-mode canvas {
    filter: invert(1) hue-rotate(180deg);
}

body.dark-mode .navbar,
body.dark-mode .offcanvas {
    background-color: #2c2c2c !important;
    color: #ddd;
}

body.dark-mode .btn-outline-primary {
    color: var(--highlight-color);
    border-color: var(--highlight-color);
}

body.dark-mode .btn-outline-primary:hover {
    background-color: var(--highlight-color);
    color: var(--text-color);
}

body.dark-mode .pageNumber {
    background-color: #000000;
    color: #ddd;
}

body.dark-mode .chord-lyric-segment span[style*="color: rgb(44, 82, 130)"] {
    color: #7eb6ff !important;
}

/* Phone UI scaling */
@media (max-width: 768px) {
  /* Navbar buttons: wrap instead of scroll */
  .navbar .btn,
  .navbar .btn-sm {
    padding: 0.25rem 0.4rem;  /* slightly smaller buttons */
    margin-right: 0.25rem !important; /* override .me-2 */
  }

  .navbar .btn-group {
    margin-right: 0.25rem; /* tighten spacing between button groups */
  }

  .navbar .toolbar-items {
    gap: 0.25rem;  /* reduce gap between toolbar items */
  }

  .navbar {
    flex-wrap: nowrap !important;  /* prevent wrapping */
    justify-content: flex-start;   /* align items to left */
  }
  
  #modeButtons {
      position: relative;
      left: 5%;
      transform: translateX(-5%);
  }

  /* Page containers: single column, full width */
  .pageContainer {
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }

  .pageWrapper {
    width: 95% !important;   /* shrink to fit phone */
    height: auto !important;
    border-width: 1px;
  }
  .pageWrapper canvas {
    width: 100% !important;
    height: auto !important;
  }

  /* Page number text smaller */
  .pageNumber {
    font-size: 10px;
    padding: 1px 4px;
  }

  /* Progress bar slimmer */
  #progressContainer {
    height: 5px;
  }

  #brand-text {
    display: none;
  }

  
}
